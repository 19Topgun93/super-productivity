<ng-container *ngIf="(isAllDataLoadedInitially$|async)">

  <!--TODO move inside page container somehow -->
  <add-task-bar (blurred)="layoutService.hideAddTaskBar()"
                *ngIf="layoutService.isShowAddTaskBar$|async"
                [@blendInOut]
                [isElevated]="true"
                class="global"></add-task-bar>
  <div *ngIf="(layoutService.isShowAddTaskBar$|async)"
       @fade
       class="backdrop"></div>

  <mat-drawer-container>
    <header class="header-wrapper"
            [class.isScrolled]="layoutService.isScrolled$|async">
      <main-header></main-header>
      <bookmark-bar></bookmark-bar>
      <banner></banner>
    </header>

    <div [@warpRoute]="getPage(o)"
         #routeWrapper
         [class.isSmallMainContainer]="isSmallMainContainer$|async"
         class="route-wrapper">
      <router-outlet #o="outlet"></router-outlet>
    </div>
    <mat-drawer (closedStart)="layoutService.hideSideNav()"
                [mode]="(layoutService.isNavOver$|async) ? 'over' : 'side'"
                [opened]="(layoutService.isShowSideNav$|async)"
                position="start">
      <side-nav></side-nav>
      <hr>
      <notes></notes>

    </mat-drawer>
    <!--    <mat-drawer (closedStart)="layoutService.hideNotes()"-->
    <!--                [mode]="(layoutService.isNotesOver$|async) ? 'over' : 'side'"-->
    <!--                [opened]="layoutService.isShowNotes$|async"-->
    <!--                position="end">-->
    <!--    </mat-drawer>-->
    <mat-drawer (closedStart)="taskService.setSelectedId(null)"
                [mode]="(layoutService.isNotesOver$|async) ? 'over' : 'side'"
                [opened]="taskService.selectSelectedTask$|async"
                position="end">
      <div style="min-width: 300px; width: 33vw; max-width:700px; min-height: 100vh">
        <task-additional-info *ngIf="taskService.selectSelectedTask$|async"
                              [task]="taskService.selectSelectedTask$|async"></task-additional-info>
      </div>
    </mat-drawer>

  </mat-drawer-container>
</ng-container>
