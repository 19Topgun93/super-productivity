<section>
  <h3 class="md-subtitle">Sync via Google Drive</h3>

  <mat-slide-toggle [(ngModel)]="cfg.isEnabled"
                    (change)="onGoogleDriveSyncToggle(cfg.isEnabled)"
                    aria-label="Enable syncing via Google Drive">
    Enable syncing via Google Drive
  </mat-slide-toggle>

  <div *ngIf="cfg?.isEnabled"
       class="ani-expand-collapse">
    <div>
      <button mat-raised-button=""
              class="md-raised"
              promise-btn
              *ngIf="!googleApiService.isLoggedIn"
              (click)="login()">
        <mat-icon>exit_to_app</mat-icon>
        Login
      </button>
      <button mat-raised-button=""
              class="md-raised"
              *ngIf="googleApiService.isLoggedIn"
              (click)="logout()">
        <mat-icon>logout</mat-icon>
        Logout
      </button>

      <button mat-raised-button=""
              class="md-raised"
              promise-btn
              *ngIf="googleApiService.isLoggedIn"
              (click)="backupNow()">
        <mat-icon>backup</mat-icon>
        Backup now
      </button>
      <button mat-raised-button=""
              class="md-raised sync-from-btn"
              promise-btn
              *ngIf="googleApiService.isLoggedIn"
              (click)="loadRemoteData()">
        <mat-icon>backup</mat-icon>
        Load From GDrive
      </button>
      <button mat-raised-button=""
              class="md-raised"
              *ngIf="googleApiService.isLoggedIn"
              external-link
              target="_blank"
              href="https://myaccount.google.com/permissions">
        <mat-icon icon="remove_circle"></mat-icon>
        Revoke permissions
      </button>
    </div>

    <div *ngIf="googleApiService.isLoggedIn"
         class="sync-file-wrapper">
      <mat-form-field class="md-block md-icon-float">
        <label>Sync file name</label>
        <mat-icon>file_upload</mat-icon>
        <input type="text"
               matInput=""
               [(ngModel)]="tmpSyncFile">
      </mat-form-field>

      <button mat-raised-button=""
              class="md-raised md-primary md-icon-button"
              aria-label="Save changed sync file name"
              (click)="changeSyncFileName(tmpSyncFile)">
        <mat-icon>save</mat-icon>
      </button>
    </div>

    <div>
      <mat-slide-toggle [(ngModel)]="cfg.isAutoLogin"
                        aria-label="Auto login at when starting app">
        Auto login at when starting app
      </mat-slide-toggle>
    </div>
    <div *ngIf="cfg?.isAutoLogin">
      <mat-slide-toggle [(ngModel)]="cfg.isLoadRemoteDataOnStartup"
                        aria-label="Load remote data on startup">
        Load remote data on startup
      </mat-slide-toggle>
    </div>
    <div *ngIf="cfg?.isAutoLogin">
      <mat-slide-toggle [(ngModel)]="cfg.isAutoSyncToRemote"
                        (change)="resetSync();"
                        aria-label="Auto sync data TO remote">
        Auto sync data TO remote
      </mat-slide-toggle>
    </div>

    <div *ngIf="cfg?.isAutoLogin">
      <mat-slide-toggle [(ngModel)]="cfg.isNotifyOnSync"
                        aria-label="Notify when syncing">
        Notify when syncing
      </mat-slide-toggle>
    </div>

    <mat-form-field class="md-block md-icon-float"
                    *ngIf="cfg?.isAutoLogin && cfg.isAutoSyncToRemote">
      <label>Sync interval (sync every x)</label>
      <mat-icon>timer</mat-icon>
      <input type="text"
             matInput=""
             input-duration
             (change)="resetSync();"
             [(ngModel)]="cfg.syncInterval">
    </mat-form-field>
  </div>
</section>
